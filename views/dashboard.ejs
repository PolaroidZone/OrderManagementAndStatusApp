<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: #f4f4f4;
      }

      .dashboard {
        max-width: 1000px;
        margin: 20px auto;
        padding: 20px;
        background: #fff;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      h1,
      h2 {
        color: #333;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }

      table,
      th,
      td {
        border: 1px solid #ddd;
      }

      th,
      td {
        text-align: left;
        padding: 8px;
      }

      th {
        background-color: #f2f2f2;
      }

      tr:nth-child(even) {
        background-color: #f9f9f9;
      }

      td:nth-child(5) {
        font-weight: bold;
      }

      td:nth-child(5):contains("Pending") {
        color: #daa520; /* Golden Rod */
      }

      td:nth-child(5):contains("Shipped") {
        color: #1e90ff; /* Dodger Blue */
      }

      td:nth-child(5):contains("Delivered") {
        color: #32cd32; /* Lime Green */
      }
    </style>
  </head>

  <body>
    <div class="dashboard">
      <h1>Admin Dashboard</h1>
      <h2>All Orders</h2>
      <table>
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Date Placed</th>
            <th>Product</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <!-- Example rows -->
          <% orders.forEach(order => { %>
          <tr>
            <td><%= order.email %></td>
            <td><%= order.createdAt %></td>
            <td>
              <% order.items.forEach(item => { %> <%= item %><br />
              <% }) %>
            </td>
            <td>
              <% 
                  // Calculate the difference in days between the ordered date and the current date
                  const orderedDate = new Date(order.createdAt);
                  const currentDate = new Date();
                  const differenceInDays = Math.floor((currentDate - orderedDate) / (1000 * 60 * 60 * 24));
          
                  // Determine the status based on the difference in days
                  let status = '';
                  if (differenceInDays === 0) {
                    status = 'In Progress';
                  } else if (differenceInDays === 1) {
                    status = 'Dispatched';
                  } else if (differenceInDays === 2) {
                    status = 'Delivered';
                  } else {
                    status = 'Pending'; // Default status
                  }
                %>
                <%= status %>
            </td>
            <td style="background-color: #328fcd;">
              <a style="padding: 20; background-color: #daa520; color: white; text-decoration: none;" href="mailto:<%= order.email %>? subject=Order recieved" ">Mail</a>
            </td> 
          </tr>

          <% }) %>
        </tbody>
      </table>
    </div>
  </body>
</html>
